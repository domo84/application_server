#!/usr/bin/env node

"use strict";

const Environment = require("../lib/environment");
const WebServer = require("../lib/web_server");
const Babel = require("../lib/babel");
const Sass = require("../lib/sass");
const StaticFiles = require("../lib/static_files");
const Watcher = require("../lib/watcher");

let env = new Environment();
env.setup();

/*
let babel = new Babel(env);
babel.run();

let sass = new Sass(env);
sass.run();

let sf = new StaticFiles(env);
sf.copy();

let ws = new WebServer(env);
pids.web_server = ws.start().pid;

let watcher = new Watcher();
pids.watcher = watcher.start().pid;

env.save(pids);
*/

const fork = require("child_process").fork;

var workers = { 
	watcher: fork(__dirname + "/../workers/watcher", [], {}),
	web_server: fork(__dirname + "/../workers/web_server", [], {}),
	reload: fork(__dirname + "/../workers/reload", [], {})
};

/*
env.save(
{
	watcher: workers.watcher.pid,
	web_server: workers.web_server.pid
});
*/

// let watcher = new Watcher({});
// watcher.start();
